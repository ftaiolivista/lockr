!function(root,factory){"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(exports=module.exports=factory(root,exports)):"function"==typeof define&&define.amd?define(["exports"],function(exports){root.SLockr=factory(root,exports)}):root.SLockr=factory(root,{})}(this,function(root,SLockr){"use strict";return Array.prototype.indexOf||(Array.prototype.indexOf=function(elt){var len=this.length>>>0,from=Number(arguments[1])||0;for(from=from<0?Math.ceil(from):Math.floor(from),from<0&&(from+=len);from<len;from++)if(from in this&&this[from]===elt)return from;return-1}),SLockr.prefix="",SLockr._getPrefixedKey=function(key,options){return options=options||{},options.noPrefix?key:this.prefix+key},SLockr.set=function(key,value,options){var query_key=this._getPrefixedKey(key,options);try{sessionStorage.setItem(query_key,JSON.stringify({data:value}))}catch(e){console&&console.warn("SLockr didn't successfully save the '{"+key+": "+value+"}' pair, because the sessionStorage is full.")}},SLockr.get=function(key,missing,options){var value,query_key=this._getPrefixedKey(key,options);try{value=JSON.parse(sessionStorage.getItem(query_key))}catch(e){value=sessionStorage[query_key]?{data:sessionStorage.getItem(query_key)}:null}return null===value?missing:"object"==typeof value&&"undefined"!=typeof value.data?value.data:missing},SLockr.sadd=function(key,value,options){var json,query_key=this._getPrefixedKey(key,options),values=SLockr.smembers(key);if(values.indexOf(value)>-1)return null;try{values.push(value),json=JSON.stringify({data:values}),sessionStorage.setItem(query_key,json)}catch(e){console.log(e),console&&console.warn("SLockr didn't successfully add the "+value+" to "+key+" set, because the sessionStorage is full.")}},SLockr.smembers=function(key,options){var value,query_key=this._getPrefixedKey(key,options);try{value=JSON.parse(sessionStorage.getItem(query_key))}catch(e){value=null}return null===value?[]:value.data||[]},SLockr.sismember=function(key,value,options){return SLockr.smembers(key).indexOf(value)>-1},SLockr.keys=function(){var keys=[],allKeys=Object.keys(sessionStorage);return 0===SLockr.prefix.length?allKeys:(allKeys.forEach(function(key){key.indexOf(SLockr.prefix)!==-1&&keys.push(key.replace(SLockr.prefix,""))}),keys)},SLockr.getAll=function(){var keys=SLockr.keys();return keys.map(function(key){return SLockr.get(key)})},SLockr.srem=function(key,value,options){var json,index,query_key=this._getPrefixedKey(key,options),values=SLockr.smembers(key,value);index=values.indexOf(value),index>-1&&values.splice(index,1),json=JSON.stringify({data:values});try{sessionStorage.setItem(query_key,json)}catch(e){console&&console.warn("SLockr couldn't remove the "+value+" from the set "+key)}},SLockr.rm=function(key){sessionStorage.removeItem(key)},SLockr.flush=function(){SLockr.prefix.length?SLockr.keys().forEach(function(key){sessionStorage.removeItem(SLockr._getPrefixedKey(key))}):sessionStorage.clear()},SLockr});